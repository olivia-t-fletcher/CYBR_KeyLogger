# Key event converter
# https://learn.microsoft.com/en-us/openspecs/windows_protocols/ms-tvtt/261ddfb0-ce10-4380-9b7a-4b50f482b8ec

import win32con

KEY_MAP = {
    # Mouse Events
    win32con.VK_LBUTTON: "left_mouse",
    win32con.VK_RBUTTON: "right_mouse",
    # Action Events
    win32con.VK_BACK: "backspace",
    win32con.VK_TAB: "tab",
    win32con.VK_RETURN: "enter",
    win32con.VK_SHIFT: "shift",
    win32con.VK_CONTROL: "ctrl",
    win32con.VK_MENU: "alt",
    win32con.VK_CAPITAL: "capslock",
    win32con.VK_ESCAPE: "esc",
    win32con.VK_SPACE: "spacebar",
    # Numpad Number Events
    win32con.VK_NUMPAD0: "numpad_0",
    win32con.VK_NUMPAD1: "numpad_1",
    win32con.VK_NUMPAD2: "numpad_2",
    win32con.VK_NUMPAD3: "numpad_3",
    win32con.VK_NUMPAD4: "numpad_4",
    win32con.VK_NUMPAD5: "numpad_5",
    win32con.VK_NUMPAD6: "numpad_6",
    win32con.VK_NUMPAD7: "numpad_7",
    win32con.VK_NUMPAD8: "numpad_8",
    win32con.VK_NUMPAD9: "numpad_9",
    # Special characters
    33: "!",
    34: "\"",
    35: "#",
    36: "$",
    37: "%",
    38: "&",
    39: "'",
    40: "(",
    41: ")",
    42: "*",
    43: "+",
    44: ",",
    45: "-",
    46: ".",
    47: "/",
    58: ":",
    59: ";",
    60: "<",
    61: "=",
    62: ">",
    63: "?",
    64: "@",
    91: "[",
    92: "\\", 
    93: "]",  
    94: "^",  
    95: "_", 
    96: "`", 
    123: "{",
    124: "|",
    125: "}",
    126: "~",
    # Number Events
    48: "0",
    49: "1",
    50: "2",
    51: "3",
    52: "4",
    53: "5",
    54: "6",
    55: "7",
    56: "8",
    57: "9",
    # Key Events
    65: "a",
    66: "b",
    67: "c",
    68: "d",
    69: "e",
    70: "f",
    71: "g",
    72: "h",
    73: "i",
    74: "j",
    75: "k",
    76: "l",
    77: "m",
    78: "n",
    79: "o",
    80: "p",
    81: "q",
    82: "r",
    83: "s",
    84: "t",
    85: "u",
    86: "v",
    87: "w",
    88: "x",
    89: "y",
    90: "z",
}

def convert_keycode(keycode):
    if keycode in KEY_MAP:
        return KEY_MAP[keycode]
    else:
        return chr(keycode).lower()
